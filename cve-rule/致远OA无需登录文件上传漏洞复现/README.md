# 致远OA无需登录文件上传漏洞复现

exp检测说明，用的fofacli框架写的脚本，目前这个框架是收费的，具体可以了解fofa官网，脚本地址https://github.com/greekn/awakening-conscience/blob/master/fofacli/seeyon_upload_2019_6_26.rb  

如果你已经拥有fofacli 框架 把该脚本放置 X:\fofacli-win32-x64-3.10.4\fofalib\fofascan\exploits 目录下。  

首先脆弱目标提取一个目标，关键词seeyon。  

![1](https://mmbiz.qpic.cn/mmbiz_png/HnRv913TtRWEH06LU6TdaYzFgCt5cHIEJbbJrsIqicnSptKq0bFhqcMEruW5zJOBuX80CHeANIK7vMx3nRqaVmQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

然后进入fofacli客户端，点击插件进行单一目标测试

![2](https://mmbiz.qpic.cn/mmbiz_png/HnRv913TtRWEH06LU6TdaYzFgCt5cHIEuu3JDwRM6HH10sRF87iaJibGHb3cbGIgl4j8FK6ibGXZicG7tVxicIjRFvA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

存在漏洞点验证，执行系统命令。

![3](https://mmbiz.qpic.cn/mmbiz_png/HnRv913TtRWEH06LU6TdaYzFgCt5cHIErVGIS6NcIwb9LX2M2El1lyH47SwA8S90pv8PFfnLZpO8XiambQ7SZHQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

payload 修改，想更改上传一句话的文件名，先找到FILENAME变量，用seeyon_filename.jar 工具进行解码加码替换FILENAME原来的内容，下载地址https://github.com/Fplyth0ner-Combie/Bug-Project-Framework。

![4](https://mmbiz.qpic.cn/mmbiz_png/HnRv913TtRWEH06LU6TdaYzFgCt5cHIECtdYAspGnsN8KKPD0LB7BIMP6LEzb9YOouiagIzWa3flWEwfg0Y95MQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

![5](https://mmbiz.qpic.cn/mmbiz_png/HnRv913TtRWEH06LU6TdaYzFgCt5cHIEzlJ1aJxeMHWY4wHKHmTWLufOiaqxbQqhibOjR7FHAiaXAYMSS5Eqdxfkg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

然后修改exp脚本把payload进行base64编码放进去。

![6](https://mmbiz.qpic.cn/mmbiz_png/HnRv913TtRWEH06LU6TdaYzFgCt5cHIEvcnN2BWx7ZYoRNOdciaOB0RMywfLEslZOeDNZJ0w4zKKwasIrTvmiaqw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

然后还需要修改一下exploit子程序下的执行命令的参数把之前修改的文件名放在这里，如果改了一句话密码，在pwd后面需要替换你改的密码。

![7](https://mmbiz.qpic.cn/mmbiz_png/HnRv913TtRWEH06LU6TdaYzFgCt5cHIExfm2emvI8vMBKbANRIbIGyQwvoVMAcpzu50t2Wwygbr3LbK4EyIG0g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

![8](https://mmbiz.qpic.cn/mmbiz_jpg/HnRv913TtRUKTkqmTaVaJuuELrQea2mTibwbwsibibicdb8r5ds4xsC7ibBfS8AV3L1Ov8HMK7FLciaWzXG9R0QMnI8w/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)


